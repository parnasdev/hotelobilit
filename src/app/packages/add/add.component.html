<div class="add-tour">
  <div class="box-info-tour">
    <div class="info-tour-header">
      <div class="right">
        <label for="">{{'تور'}}</label>
        <h2 class="text-dark">اطلاعات تور</h2>
      </div>

      <div class="left d-flex align-items-center">
        <div *ngIf="session.checkItemPermission('tours.status')">
          <div class="selectdiv">
            <label>
              <select [formControl]="status_idFC">
                <option *ngFor="let status of this.statuses; let i = index"
                        [value]="status.id">{{ status.name }}</option>
                <!-- <option value="Draft" selected>پیش نویس</option>
                <option value="Accepted">تایید شده</option>
                <option value="NotAccepted">عدم تایید</option>
                <option value="Pending">در انتظار تایید</option>
                <option value="Suspended">معلق شده/منقضی شده</option>
                <option value="Completion">تکمیل شده</option> -->
              </select>
              <div *ngIf="errorService.hasError('status_id')">
                <span class="text-danger">{{errorService.getError('status_id')}}</span>
              </div>
            </label>
          </div>

        </div>
        <div class="selectdiv me-2">
          <label>
            <select [formControl]="tour_typeFC">
              <option [ngValue]="true">داخلی</option>
              <option [ngValue]="false">خارجی</option>
            </select>
          </label>
        </div>
      </div>
    </div>
    <div style="background:#fff;border:1px solid #e0e0e0" class="info-tour-body">
      <div class="top-title">
        <!-- title field -->
        <div style="margin-top: 0 !important;position: relative;top: -13px;width: 32% !important;" class="item-info">
          <label for="">عنوان تور (داینامیک ایجاد می شود)</label>
          <input [formControl]="titleFC"  type="text">
          <div *ngIf="errorService.hasError('title')">
            <span class="text-danger">{{errorService.getError('title')}}</span>
          </div>
        </div>
      </div>

      <div style="align-items: center !important;" class="top">

        <!-- on field -->
        <div class="item-info-2 item-info-material">
          <div class="select-info mt-3">

            <label for="">شهر مبدا</label>
            <prs-select-city [title]="'انتخاب کنید'" [cities]="cities" (citySelected)="getStCity($event)"></prs-select-city>
            <div *ngIf="errorService.hasError('origin_id')">
              <span class="text-danger">{{errorService.getError('origin_id')}}</span>
            </div>
          </div>
        </div>
        <!-- destination field -->
        <div class="item-info item-info-material mt-3">
          <div class="select-info">
            <label for="">شهر مقصد</label>
            <prs-select-city [title]="'انتخاب کنید'" [cities]="cities" (citySelected)="getEndCity($event)"></prs-select-city>

            <div *ngIf="errorService.hasError('destination_id')">
              <span class="text-danger">{{errorService.getError('destination_id')}}</span>
            </div>
          </div>
        </div>
        <!-- stDate field -->
        <div class="item-info w-25">
          <label for="">تاریخ ورود به هتل</label>
          <mat-form-field class="example-full-width" appearance="fill">
            <input matInput [matDatepicker]="picker1" (dateChange)="dateChanged()" [formControl]="checkinFC"
                   [min]="minDate" (click)="picker1.open()">
            <mat-datepicker #picker1></mat-datepicker>
          </mat-form-field>
          <div *ngIf="errorService.hasError('checkin')">
            <span class="text-danger">{{errorService.getError('checkin')}}</span>
          </div>
        </div>
        <!-- enDate field -->
        <div class="item-info w-25">
          <label for="">تاریخ خروج از هتل</label>
          <mat-form-field class="example-full-width" appearance="fill">
            <input matInput [formControl]="checkoutFC" (dateChange)="dateChanged()" [matDatepicker]="picker2"
                   [min]="minDate" (click)="picker2.open()">
            <mat-datepicker #picker2></mat-datepicker>
          </mat-form-field>
          <div *ngIf="errorService.hasError('checkout')">
            <span class="text-danger">{{errorService.getError('checkout')}}</span>
          </div>
        </div>
        <div class="item-info w-25">
          <label for="">تاریخ انقضا پکیج</label>
          <mat-form-field class="example-full-width" appearance="fill">
            <input matInput [formControl]="expired_atFC" [matDatepicker]="picker3" [min]="minDate"
                   (click)="picker3.open()">
            <mat-datepicker #picker3></mat-datepicker>
          </mat-form-field>
          <div *ngIf="errorService.hasError('expired_at')">
            <span class="text-danger">{{errorService.getError('expired_at')}}</span>
          </div>
        </div>
        <div class="item-info w-22">
          <label style="margin-bottom: 14px;position: relative;top: -27px"  for="">تعداد شب و روز</label>
                 <span style="border-bottom: 1px dashed #ededed;position: relative;top: -8px"  class="bold-600 w-100 text-center h-30  d-flex justify-content-center font-size-14" for="">
           {{night_numFC.value}}شب
          و
                   {{day_numFC.value}} روز
        </span>
        </div>


      </div>
    </div>
  </div>
  <div class="p-list-fly">
    <div class="info-tour-header">
      <div class="right">
        <h2 class="text-dark">اطلاعات پرواز</h2>
      </div>
    </div>
    <div class="w-100 p-transfer">
      <div class="item-header">
        <span>#</span>
        <span>مسیر رفت-برگشت</span>
        <span>ایرلاین رفت-برگشت</span>
        <span>کلاس</span>
        <span>تاریخ رفت</span>
        <span>تاریخ برگشت</span>
        <span>قیمت بزرگسال</span>
        <span>قیمت کودک</span>
        <span>قیمت نوزاد</span>
        
        <span>ظرفیت</span>
      </div>
      <div class="info-tour-body-2">
        <div class="empty-transfer" *ngIf="transferRates.length === 0">
          <span>پروازی یافت نشد</span>
        </div>
        <div *ngIf="transferRates.length > 0">
          <div class="item" *ngFor="let item of transferRates">
            <mat-checkbox [(ngModel)]="item.isChecked" (ngModelChange)="changeTransferRates()"></mat-checkbox>
            <span>{{item.origin_name }} - {{ item.destination_name }}</span>
            <span>{{ item.airline_name }} - {{ item.return_flight.airline_name }}</span>
            <span>{{ item.cabin_type }} - {{ item.return_flight.cabin_type }}</span>

            <span>{{ calenderService.convertDate(item.date, 'fa') }}</span>
            <span>{{ calenderService.convertDate(item.return_flight.date, 'fa') }}</span>
            <span>{{ (item.adl_price + item.return_flight.adl_price)  | sperator }}</span>
            <span>{{ (item.chd_price + item.return_flight.chd_price) | sperator }}</span>
            <span>{{ (item.inf_price + item.return_flight.inf_price) | sperator }}</span>
            <span>{{ item.capacity }}</span>
          </div>
        </div>
        <div *ngIf="errorService.hasError('flights')">
          <span class="text-danger">لطفا پرواز خود را انتخاب کنید</span>
        </div>
      </div>

    </div>

  </div>


  <div style="position: relative" class="w-100">
    <button class="btn-base w-100-mobi m-top-20 font-size-13 px-3" (click)="addHotel()">اضافه کردن هتل</button>
    <div class="w-100">
      <div class="item-package" *ngFor="let item of packages;let i=index">
        <span class="number">{{ i + 1 }}</span>
        <div class="d-flex middle-item">
          <h5>انتخاب هتل</h5>

<!--            <select class="w-100" [(ngModel)]="item.hotel_id">-->
<!--              <option *ngFor="let item of hotels" [value]="item.id">{{ item.title + ' ( ' + item.stars + ' ستاره' + ' )' }}</option>-->
<!--            </select>-->
          <div class="spinner-border" *ngIf="hotelLoading" role="status"></div>
          <prs-custom-select-hotel class="hotel-input"  [hotels]="hotels" (hotelSelected)="getHotelSelected($event,i)"></prs-custom-select-hotel>

          <button style="width: 150px !important;" class="btn-base" (click)="openPricingCalendar(i,item.hotel_id)">قیمت
            گذاری
          </button>
          <div class="d-flex checkbox-bottun-parent">

            <div class="d-flex p-checkbox align-items-center justify-content-end">
              <label>ویژه</label>
              <mat-checkbox [(ngModel)]="item.offered"></mat-checkbox>
            </div>
          </div>

        </div>
        <i class="icon-cancel" (click)="removePackage(i)"></i>
      </div>
    </div>
    <div class="w-100 d-flex justify-content-end">
      <button class="btn-base w-100-mobi m-top-20 font-size-13 px-3" (click)="addHotel()">اضافه کردن هتل</button>
    </div>
  </div>

  <!-- <prs-detail-package class="w-100"></prs-detail-package> -->

  <button class="btn-base w-100-mobi m-top-12" style="width: 15%;" (click)="submit()">ثبت تور</button>

</div>
